<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Eazy Chat</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="app-shell">
      <aside class="sidebar">
        <button id="sidebar-toggle" class="ghost icon sidebar-toggle" aria-label="Hide menu">â˜°</button>
        <div class="sidebar-content">
          <div class="brand">
            <div class="logo">ðŸ¤–</div>
            <div>
              <h1>AI Eazy Chat</h1>
              <p class="muted">Multi-chat workspace</p>
            </div>
          </div>
          <div class="controls">
            <button id="new-folder" class="ghost">+ Folder</button>
            <button id="new-chat" class="primary">+ New Chat</button>
            <button id="settings-button" class="ghost icon" aria-label="Settings">âš™</button>
          </div>
          <section class="folders">
            <div class="section-title">Folders</div>
            <ul id="folder-list" class="folder-list"></ul>
          </section>
        </div>
      </aside>
      <main class="workspace">
        <section class="attachments">
          <div class="attachment-header">
            <div>
              <strong>Context files</strong>
              <p class="muted">Attach text files; their contents are sent with every message.</p>
            </div>
            <label class="file-label" for="file-input">Add file</label>
            <input id="file-input" type="file" accept=".txt,.md,.json,.csv" multiple hidden />
          </div>
          <ul id="file-list" class="pill-list"></ul>
        </section>
        <section class="chat-area" id="chat-area">
          <div id="messages" class="messages"></div>
        </section>
        <footer class="composer">
          <div class="composer-box">
            <div class="textarea-wrapper">
              <textarea id="prompt" rows="3" placeholder="Write your message..."></textarea>
              <button id="expand-textarea" class="expand-icon" aria-label="Expand message field" title="Expand message field">â¤¢</button>
            </div>
            <div class="composer-buttons">
              <button id="canvas-button" class="ghost" aria-label="Open canvas" title="Canvas">Canvas</button>
              <button id="send" class="primary">Send</button>
              <button id="cancel" class="ghost" aria-label="Cancel request" disabled>Cancel</button>
            </div>
          </div>
        </footer>
      </main>
    </div>
    <div id="toast" class="toast"></div>
    <div id="folder-overlay" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div>
            <p class="muted">Folders</p>
            <h3>Create folder</h3>
          </div>
          <button id="close-folder" class="ghost icon" aria-label="Close new folder dialog">âœ•</button>
        </div>
        <div class="modal-body">
          <label class="stack" for="folder-name-input">
            <span class="label">Folder name</span>
            <input
              id="folder-name-input"
              class="text-input"
              type="text"
              placeholder="e.g. Research notes"
              autocomplete="off"
            />
          </label>
        </div>
        <div class="modal-footer">
          <button id="cancel-folder" class="ghost">Cancel</button>
          <button id="create-folder" class="primary">Create</button>
        </div>
      </div>
    </div>
    <div id="settings-overlay" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div>
            <p class="muted">Workspace Settings</p>
            <h3>Model & Persona</h3>
          </div>
          <button id="close-settings" class="ghost icon" aria-label="Close settings">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="tabs">
            <button id="tab-model" class="tab-button active" data-tab="model">Model & API Key</button>
            <button id="tab-persona" class="tab-button" data-tab="persona">Persona</button>
            <button id="tab-theme" class="tab-button" data-tab="theme">Theme</button>
          </div>
          <div id="tab-panel-model" class="tab-panel active">
            <label class="stack" for="settings-model">
              <div class="label-row">
                <span class="label">Model</span>
                <button id="refresh-models" class="ghost" type="button">Refresh list</button>
              </div>
              <div class="model-field">
                <div class="model-input-row">
                  <input
                    id="settings-model"
                    class="text-input"
                    type="text"
                    placeholder="Select a model"
                    autocomplete="off"
                  />
                  <button id="model-toggle" class="ghost icon" type="button" aria-label="Toggle model list">
                    â–¾
                  </button>
                </div>
                <div id="model-dropdown" class="model-dropdown" role="listbox" aria-label="Model list">
                  <div class="model-search-row">
                    <input
                      id="model-search"
                      class="text-input"
                      type="text"
                      placeholder="Search models"
                      autocomplete="off"
                    />
                  </div>
                  <ul id="model-list" class="model-list"></ul>
                </div>
              </div>
            </label>
            <label class="stack" for="settings-api-key">
              <span class="label">OpenRouter API Key</span>
              <input
                id="settings-api-key"
                class="text-input"
                type="password"
                placeholder="Leave empty to use environment variable"
                autocomplete="off"
              />
              <p class="muted" style="font-size: 0.875rem; margin-top: 4px;">
                If set, this will override the OPENROUTER_API_KEY environment variable.
              </p>
            </label>
          </div>
          <div id="tab-panel-persona" class="tab-panel">
            <div class="personas-header">
              <h4 style="margin: 0; font-size: 14px; color: var(--text);">Personas</h4>
              <button id="add-persona-button" class="primary" type="button">+ Add Persona</button>
            </div>
            <ul id="personas-list" class="personas-list"></ul>
          </div>
          <div id="tab-panel-theme" class="tab-panel">
            <label class="stack" for="theme-mode">
              <span class="label">Color Mode</span>
              <div class="theme-mode-toggle">
                <button id="theme-mode-dark" class="theme-mode-button" data-mode="dark">Dark</button>
                <button id="theme-mode-light" class="theme-mode-button" data-mode="light">Light</button>
              </div>
            </label>
            <label class="stack" for="theme-hue">
              <span class="label">Color Hue</span>
              <div class="theme-hue-control">
                <input type="range" id="theme-hue" min="0" max="360" value="160" />
                <div class="theme-hue-preview">
                  <div class="theme-hue-indicator"></div>
                  <span class="theme-hue-value">160Â°</span>
                </div>
              </div>
            </label>
            <div class="theme-preview">
              <div class="theme-preview-card">
                <div class="theme-preview-header">Preview</div>
                <div class="theme-preview-content">
                  <div class="theme-preview-button">Button</div>
                  <div class="theme-preview-text">Sample text</div>
                </div>
              </div>
            </div>
          </div>
          <div id="persona-modal" class="modal-overlay">
            <div class="modal">
              <div class="modal-header">
                <div>
                  <p class="muted">Personas</p>
                  <h3 id="persona-modal-title">New Persona</h3>
                </div>
                <button id="close-persona-modal" class="ghost icon" aria-label="Close persona dialog">âœ•</button>
              </div>
              <div class="modal-body">
                <label class="stack" for="persona-name-input">
                  <span class="label">Name</span>
                  <input
                    id="persona-name-input"
                    class="text-input"
                    type="text"
                    placeholder="e.g. Playful Pirate"
                    autocomplete="off"
                  />
                </label>
                <label class="stack" for="persona-content-input">
                  <span class="label">System Prompt</span>
                  <textarea
                    id="persona-content-input"
                    rows="4"
                    placeholder="e.g. You are a playful pirate with a love for TypeScript."
                  ></textarea>
                </label>
              </div>
              <div class="modal-footer">
                <button id="cancel-persona" class="ghost">Cancel</button>
                <button id="save-persona" class="primary">Save</button>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="close-settings-cta" class="primary">Done</button>
        </div>
      </div>
    </div>
    <div id="confirm-overlay" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div>
            <p id="confirm-context" class="muted">Confirm</p>
            <h3 id="confirm-title">Are you sure?</h3>
          </div>
          <button id="close-confirm" class="ghost icon" aria-label="Close confirmation dialog">âœ•</button>
        </div>
        <div class="modal-body">
          <p id="confirm-message" class="muted confirm-message"></p>
        </div>
        <div class="modal-footer">
          <button id="cancel-confirm" class="ghost">Cancel</button>
          <button id="confirm-action" class="primary danger">Confirm</button>
        </div>
      </div>
    </div>
    <div id="canvas-list-overlay" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div>
            <p class="muted">Canvas</p>
            <h3>Canvas Documents</h3>
          </div>
          <button id="close-canvas-list" class="ghost icon" aria-label="Close canvas list">âœ•</button>
        </div>
        <div class="modal-body">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h4 style="margin: 0; font-size: 14px; color: var(--text);">Canvases</h4>
            <button id="new-canvas-button" class="primary" type="button">+ New Canvas</button>
          </div>
          <ul id="canvas-list" class="personas-list"></ul>
        </div>
      </div>
    </div>
    <div id="canvas-overlay" class="modal-overlay">
      <div class="canvas-modal">
        <div class="canvas-header">
          <input type="text" id="canvas-name-input" class="canvas-name-input" placeholder="Canvas name" />
          <div class="canvas-actions">
            <button id="canvas-select-all" class="ghost" title="Select all blocks">Select All</button>
            <button id="canvas-deselect-all" class="ghost" title="Deselect all blocks">Deselect All</button>
            <button id="canvas-copy-all" class="ghost" title="Copy all blocks as text">Copy All</button>
            <button id="canvas-list-from-canvas" class="ghost" title="Canvas list">â˜°</button>
            <button id="canvas-ai-edit" class="ghost">AI Edit</button>
            <button id="canvas-new-block" class="ghost">+ Block</button>
            <button id="close-canvas" class="ghost icon" aria-label="Close canvas">âœ•</button>
          </div>
        </div>
        <div id="canvas-content" class="canvas-content" contenteditable="false">
          <!-- Blocks rendered here -->
        </div>
        <div class="canvas-footer">
          <button id="canvas-undo" class="ghost" disabled>Undo</button>
          <button id="canvas-redo" class="ghost" disabled>Redo</button>
        </div>
      </div>
    </div>
    <div id="canvas-ai-edit-overlay" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div>
            <p class="muted">Canvas</p>
            <h3>AI Edit Instructions</h3>
          </div>
          <button id="close-canvas-ai-edit" class="ghost icon" aria-label="Close AI edit dialog">âœ•</button>
        </div>
        <div class="modal-body">
          <label class="stack" for="canvas-ai-instruction">
            <span class="label">Edit Instruction</span>
            <textarea
              id="canvas-ai-instruction"
              class="text-input"
              rows="4"
              placeholder="Enter your edit instruction for the canvas (e.g., 'Make the second paragraph more concise', 'Add a summary at the end')"
            ></textarea>
          </label>
          <p class="muted" style="font-size: 0.875rem; margin-top: 4px;">
            The AI will edit the selected blocks (use checkboxes on the right of blocks to select). If no blocks are selected, it will edit the entire canvas.
          </p>
        </div>
        <div class="modal-footer">
          <button id="cancel-canvas-ai-edit" class="ghost">Cancel</button>
          <button id="apply-canvas-ai-edit" class="primary">Apply Edit</button>
        </div>
      </div>
    </div>
    <div id="canvas-delete-block-overlay" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div>
            <p class="muted">Canvas</p>
            <h3>Delete Block</h3>
          </div>
          <button id="close-canvas-delete-block" class="ghost icon" aria-label="Close delete dialog">âœ•</button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this block? This action cannot be undone, but you can use Undo to restore it.</p>
        </div>
        <div class="modal-footer">
          <button id="cancel-canvas-delete-block" class="ghost">Cancel</button>
          <button id="confirm-canvas-delete-block" class="danger">Delete Block</button>
        </div>
      </div>
    </div>
    <script src="/app.js" type="module"></script>
  </body>
</html>
